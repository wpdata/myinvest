# MyInvest V0.3 用户使用指南

**版本**: V0.3 Production-Ready Enhancement
**更新日期**: 2025-10-24
**适用用户**: 投资者、量化交易员

---

## 📋 目录

1. [快速开始](#快速开始)
2. [监视列表管理](#监视列表管理)
3. [并行回测](#并行回测)
4. [参数优化](#参数优化)
5. [报告导出](#报告导出)
6. [期货期权交易](#期货期权交易)
7. [组合策略](#组合策略)
8. [多时间框架分析](#多时间框架分析)
9. [风险监控](#风险监控)
10. [技术指标](#技术指标)

---

## 快速开始

### 启动应用

```bash
cd /Users/pw/ai/myinvest/investapp
streamlit run investapp/pages/1_仪表盘_Dashboard.py
```

### 首次使用流程

1. **添加监视列表** → 页面11：监视列表
2. **运行回测** → 页面6：策略回测
3. **查看风险** → 页面12：风险监控
4. **导出报告** → 回测结果页面

---

## 监视列表管理

### 功能位置
**页面11：监视列表_Watchlist**

### 添加股票到监视列表

1. 输入股票代码（例如：`600519.SH`）
2. 选择分组（例如：白酒板块）
3. 选择资产类型：
   - 📈 股票 (Stock)
   - 📊 期货 (Futures)
   - 📉 期权 (Options)
4. 点击"添加"按钮

### 批量导入

1. 准备CSV文件，格式：
   ```csv
   symbol,group_name,status
   600519.SH,白酒,active
   000858.SZ,白酒,active
   ```
2. 点击"批量导入"标签
3. 上传CSV文件

### 管理监视列表

- **暂停/恢复**: 点击 ⏸️ 或 ▶️
- **删除**: 点击 🗑️
- **筛选**: 使用分组、状态、资产类型筛选器

---

## 并行回测

### 功能位置
**页面6：策略回测_Backtest**

### 运行回测

1. **选择策略**:
   - Livermore 市场趋势策略
   - Kroll 期货趋势策略
   - 多时间框架策略
   - 多指标组合策略

2. **设置参数**:
   - 回测时间范围
   - 初始资金
   - 手续费率

3. **选择股票**:
   - 从监视列表选择
   - 或手动输入代码

4. **运行**:
   - 点击"开始回测"
   - 等待进度条完成（<3分钟/10股票）

### 回测结果解读

- **总收益率**: 策略盈亏百分比
- **夏普比率**: 风险调整后收益（>1为优秀）
- **最大回撤**: 最大亏损幅度
- **胜率**: 盈利交易占比
- **权益曲线**: 资金变化图表

---

## 参数优化

### 功能位置
**页面12：参数优化_Optimizer**

### 网格搜索

1. **选择策略和参数范围**:
   ```
   MA快线周期: 5-20 (步长5)
   MA慢线周期: 20-60 (步长10)
   ```

2. **运行优化**:
   - 系统自动测试所有参数组合
   - 显示热力图

3. **选择最优参数**:
   - 按夏普比率排序
   - 查看详细回测结果

### Walk-Forward 验证

- 防止过拟合
- 滚动验证参数稳定性
- 推荐用于生产环境

---

## 报告导出

### 支持格式

1. **PDF 报告**:
   - 专业排版
   - 中文字体支持
   - 图表嵌入

2. **Excel 报告**:
   - 多工作表
   - 条件格式化
   - 公式支持

3. **Word 报告**:
   - 可编辑
   - 样式丰富

### 导出步骤

1. 完成回测后，点击"导出报告"
2. 选择格式（PDF/Excel/Word）
3. 点击"下载"
4. 文件保存在 `reports/` 目录

---

## 期货期权交易

### 期货交易 (T+0)

**特点**:
- 保证金交易（15%保证金率）
- 双向交易（做多/做空）
- 强制平仓风险

**使用示例**:
```python
# 期货代码格式: IF2506.CFFEX
symbol = "IF2506.CFFEX"  # 沪深300期货
```

**强制平仓**:
- 系统自动计算强平价
- 保证金率<10%触发强平
- 回测引擎模拟强平事件

### 期权交易

**支持策略**:
- 备兑开仓 (Covered Call)
- 保护性看跌 (Protective Put)
- 跨式组合 (Straddle)
- 蝶式价差 (Butterfly Spread)

**Greeks 跟踪**:
- Delta: 价格敏感度
- Gamma: Delta 变化率
- Vega: 波动率敏感度
- Theta: 时间价值衰减

---

## 组合策略

### 功能位置
**页面13：组合策略_Combinations**

### 创建备兑开仓

1. 选择"备兑开仓"模板
2. 输入参数:
   - 股票: 600519.SH
   - 股票价格: 1800
   - 行权价: 1900
   - 权利金: 50
3. 点击"生成策略"

### 查看 P&L 曲线

- 横轴: 标的价格
- 纵轴: 盈亏金额
- 盈亏平衡点自动标注
- 最大盈利/亏损显示

### 保证金优惠

- 系统自动识别对冲关系
- 保证金减免最高30%
- 例如：备兑开仓享受对冲减免

---

## 多时间框架分析

### 功能位置
**页面14：策略推荐_Recommendations**

### 时间框架选择

1. **日线 (Daily)**:
   - 适合短期交易
   - 5日/20日均线

2. **周线 (Weekly)**:
   - 适合中长期投资
   - 10周/20周均线

3. **日线+周线组合 (Multi-TF)**:
   - **推荐使用**
   - 周线确认趋势
   - 日线寻找入场点
   - 减少假信号

### 信号解读

**高信心信号**:
```
周线: ↑ 上升趋势
日线: BUY (金叉)
━━━━━━━━━━━━━
综合信号: 买入 (HIGH)
```

**观望信号**:
```
周线: ↓ 下降趋势
日线: BUY (金叉)
━━━━━━━━━━━━━
综合信号: 观望 (信号不一致)
```

---

## 风险监控

### 功能位置
**页面12：风险监控_Risk**

### 关键指标

1. **VaR (95%, 1日)**:
   - 最大潜在损失
   - 95%置信度
   - 例如：¥3,200 (3.2% of assets)

2. **CVaR (条件VaR)**:
   - 极端情况下的平均损失
   - 尾部风险评估

3. **保证金使用率**:
   - 已用保证金 / 总资金
   - 建议 <70%

4. **强平预警**:
   - 距离强平价百分比
   - <5%: 黄色预警
   - <3%: 红色警告

### 相关性分析

- 持仓相关性热力图
- 识别高度相关资产（>0.7）
- 建议分散投资

### 集中度风险

- 单一持仓占比
- Top 3 持仓集中度
- HHI 指数（<0.25为分散）

---

## 技术指标

### MACD (平滑异同移动平均线)

**参数**:
- 快线: 12
- 慢线: 26
- 信号线: 9

**信号**:
- 金叉: MACD上穿信号线 → 买入
- 死叉: MACD下穿信号线 → 卖出

### KDJ (随机指标)

**参数**:
- 周期: 9
- 超卖: <20
- 超买: >80

**信号**:
- K线上穿D线且在超卖区 → 买入
- K线下穿D线且在超买区 → 卖出

### 布林带 (Bollinger Bands)

**参数**:
- 周期: 20
- 标准差: 2

**信号**:
- 价格触及下轨 → 超卖 → 买入
- 价格触及上轨 → 超买 → 卖出

### 多指标组合

**投票系统**:
- 4个指标：MACD + KDJ + 布林带 + 成交量
- 需3+票才发出信号
- 4票 = 高信心，3票 = 中等信心

---

## 常见问题

### Q: 回测速度慢怎么办？
A: 使用并行回测功能，10股票<3分钟完成。

### Q: 如何避免过拟合？
A: 使用 Walk-Forward 验证，检查参数稳定性。

### Q: 期货强制平仓如何避免？
A:
1. 保持保证金使用率 <70%
2. 设置止损
3. 监控风险仪表板

### Q: 如何选择时间框架？
A:
- 新手：日线+周线组合
- 短线：日线
- 长线：周线

### Q: 数据来源是什么？
A: efinance（主）→ AkShare（备用）

---

## 技术支持

**问题反馈**: https://github.com/your-repo/issues
**文档更新**: 2025-10-24
**版本**: V0.3
